<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ARESXIONG</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="ARESXIONG">
<meta property="og:url" content="http://yoursite.com/page/9/index.html">
<meta property="og:site_name" content="ARESXIONG">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ARESXIONG">
  
    <link rel="alternate" href="/atom.xml" title="ARESXIONG" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ARESXIONG</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-android_handler2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/05/android_handler2/" class="article-date">
  <time datetime="2015-11-05T04:23:29.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/android/">android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/05/android_handler2/">Android Handler机制 (二)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在android中提供了一种异步回调机制Handler,使用它，我们可以在完成一个很长时间的任务后做出相应的通知。</p>
<h2 id="handler基本使用："><a href="#handler基本使用：" class="headerlink" title="handler基本使用："></a>handler基本使用：</h2><p>在主线程中，使用handler很简单，new一个Handler对象实现其handleMessage方法，在handleMessage中提供收到消息后相应的处理方法即可，这里不对handler使用进行详细说明，在看本博文前，读者应该先掌握handler的基本使用，我这里主要深入描述handler的内部机制。现在我们首先就有一个问题，我们使用myThreadHandler.sendEmptyMessage(0);发送一个message对象，那么Handler是如何接收该message对象并处理的呢？我先画一个数据结构图：<br><img src="http://7xo1gw.com1.z0.glb.clouddn.com/coding_android_handler_1.jpg" alt="数据结构图"></p>
<p>从这个图中我们很清楚可以看到调用sendEmptyMessage后，会把 Message对象放入一个MessageQueue队列，该队列属于某个Looper对象，每个Looper对象通过 ThreadLocal.set(new Looper())跟一个Thread绑定了，Looper对象所属的线程在Looper.Loop方法中循环执行从MessageQueue队列读取 Message对象，并把Message对象交由Handler处理，调用Handler的dispatchMessage方法。<br>     现在我们再来看一下使用Handler的基本实现代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">               <span class="comment">// 主线程中新建一个handler</span></div><div class="line">                normalHandler = <span class="keyword">new</span> Handler() &#123;</div><div class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(android.os.Message msg)</span> </span>&#123;</div><div class="line">                                btnSendMsg2NormalHandler.setText(<span class="string">"normalHandler"</span>);</div><div class="line">                                Log.d(Constant.TAG, MessageFormat.format(<span class="string">"Thread[&#123;0&#125;]--normalHandler handleMessage run..."</span>, Thread.currentThread()</div><div class="line">                                                .getName()));</div><div class="line">                        &#125;</div><div class="line">                &#125;;</div><div class="line">...</div><div class="line"><span class="comment">//发送消息到hanlder</span></div><div class="line">myThreadHandler.sendEmptyMessage(<span class="number">0</span>);</div></pre></td></tr></table></figure></p>
<p>你现在已经很清楚了sendEmptyMessage到handleMessage的过程，途中经过Looper.MessageQueue队列，转由Looper所在的线程去处理了，这是一个异步的过程，当然Looper所在的线程也可以是sendEmptyMessage所在的线程。看了上面你也许还是迷惑不解，那么什么要Looper了，跟我们要用的Handler又有啥鸟关系呢？</p>
<p>我在前面一直强调在主线程中使用handler，为什么要这么说呢，因为你在自己new一个新线程中去像我前面那样简单建立一个Handler，程序执行是会报错的：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()</div><div class="line"> at android.os.Handler.&lt;init&gt;(Handler.java:121)</div><div class="line"> at com.cao.android.demos.handles.HandleTestActivity$MyThread$1.&lt;init&gt;(HandleTestActivity.java:86)</div><div class="line"> at com.cao.android.demos.handles.HandleTestActivity$MyThread.run(HandleTestActivity.java:86)</div></pre></td></tr></table></figure></p>
<p>为什么在主线程中不会报错，而在自己新建的线程中就会报这个错误呢？很简单，因为主线程它已经建立了Looper，你可以打开ActivityThread的源码看一下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    SamplingProfilerIntegration.start();</div><div class="line">    Process.setArgV0(<span class="string">"&lt;pre-initialized&gt;"</span>);</div><div class="line">    Looper.prepareMainLooper();</div><div class="line">    ActivityThread thread = <span class="keyword">new</span> ActivityThread();</div><div class="line">    thread.attach(<span class="keyword">false</span>);</div><div class="line">    Looper.loop();</div><div class="line">    <span class="keyword">if</span> (Process.supportsProcesses()) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Main thread loop unexpectedly exited"</span>);</div><div class="line">    &#125;</div><div class="line">    thread.detach();</div><div class="line">    String name = (thread.mInitialApplication != <span class="keyword">null</span>)</div><div class="line">        ? thread.mInitialApplication.getPackageName()</div><div class="line">        : <span class="string">"&lt;unknown&gt;"</span>;</div><div class="line">    Slog.i(TAG, <span class="string">"Main thread of "</span> + name + <span class="string">" is now exiting"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在main函数中它已经做了这个事情了，为什么要调用Looper.prepareMainLooper();Looper.loop();我们可以进去看一下，在prepareMainLooper方法中新建了一个looper对象，并与当前进程进行了绑定，而在Looper.loop方法中，线程建立消息循环机制，循环从MessageQueue获取Message对象，调用msg.target.dispatchMessage(msg);进行处理msg.target在myThreadHandler.sendEmptyMessage(0)设置进去的，因为一个Thead中可以建立多个Hander，通过msg.target保证MessageQueue中的每个msg交由发送message的handler进行处理，那么Handler又是怎样与 Looper建立联系的呢，在Handler构造函数中有这样一段代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mLooper = Looper.myLooper();</div><div class="line"> <span class="keyword">if</span> (mLooper == <span class="keyword">null</span>) &#123;</div><div class="line">     <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</div><div class="line">         <span class="string">"Can't create handler inside thread that has not called Looper.prepare()"</span>);</div><div class="line"> &#125;</div><div class="line"> mQueue = mLooper.mQueue;</div></pre></td></tr></table></figure></p>
<p>在新建Handler时需要设置mLooper成员，Looper.myLooper是从当前线程中获取绑定的Looper对象：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Looper <span class="title">myLooper</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (Looper)sThreadLocal.get();</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>若Looper对象没有创建，就会抛异常”Can’t create handler inside thread that has not called Looper.prepare()”这跟我前面讲的是一致的。所以我们在一个新线程中要创建一个Handler就需要这样写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;                </div><div class="line">                Log.d(Constant.TAG, MessageFormat.format(<span class="string">"Thread[&#123;0&#125;]-- run..."</span>, Thread</div><div class="line">                                .currentThread().getName()));</div><div class="line">                <span class="comment">// 其它线程中新建一个handler</span></div><div class="line">                Looper.prepare();<span class="comment">// 创建该线程的Looper对象，用于接收消息,在非主线程中是没有looper的所以在创建handler前一定要使用prepare()创建一个Looper</span></div><div class="line">                myThreadHandler = <span class="keyword">new</span> Handler() &#123;</div><div class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(android.os.Message msg)</span> </span>&#123;</div><div class="line">                                Log.d(Constant.TAG, MessageFormat.format(<span class="string">"Thread[&#123;0&#125;]--myThreadHandler handleMessage run..."</span>, Thread</div><div class="line">                                                .currentThread().getName()));</div><div class="line">                        &#125;</div><div class="line">                &#125;;</div><div class="line">                Looper.myLooper().loop();<span class="comment">//建立一个消息循环，该线程不会退出</span></div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在，你应该对Handler的机制有所了解了吧，若有什么疑问，欢迎在评论中提出在其它线程中Handler使用主线程的Looper,前面我说了在新线程中要新建一个Handler需要调用Looper.prepare();也有另一种方法就是使用主线程中的Looper,那就不必新建Looper对象了:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">threadMainLoopHandler =<span class="keyword">new</span> Handler(Looper.getMainLooper())&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(android.os.Message msg)</span> </span>&#123;</div><div class="line">                Log.d(Constant.TAG, MessageFormat.format(<span class="string">"Thread[&#123;0&#125;]--threadMainLoopHandler handleMessage run..."</span>, Thread</div><div class="line">                                .currentThread().getName()));                                        </div><div class="line">        &#125;</div><div class="line">        <span class="comment">//该handleMessage方法将在mainthread中执行</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>这时候注意不要在handleMessage做太多的操作，因为它在主线程中执行，会影响主线程执行ui更新操作。使用Message.callback回调<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispatchMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">     <span class="keyword">if</span> (msg.callback != <span class="keyword">null</span>) &#123;</div><div class="line">         handleCallback(msg);</div><div class="line">     &#125; <span class="keyword">else</span> &#123;</div><div class="line">         <span class="keyword">if</span> (mCallback != <span class="keyword">null</span>) &#123;</div><div class="line">             <span class="keyword">if</span> (mCallback.handleMessage(msg)) &#123;</div><div class="line">                 <span class="keyword">return</span>;</div><div class="line">             &#125;</div><div class="line">         &#125;</div><div class="line">         handleMessage(msg);</div><div class="line">     &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>从dispatchMessage定义可以看出，如果Message对象自带callback对象，handler不会执行handleMessage方法而是执行message.callback中定义的run方法，当然callback还是在handler关联的looper所绑定的线程中执行的。实 际上Handler.post(Runnable r)方法就是把r添加到一个msg.callback的,也就是说，下面两种写法，没有什么区别：</p>
<h3 id="1-使用Message-callback"><a href="#1-使用Message-callback" class="headerlink" title="1.使用Message.callback"></a>1.使用Message.callback</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Message msg = Message.obtain(myThreadHandler,<span class="keyword">new</span> Runnable() &#123;  </div><div class="line">      </div><div class="line">    <span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line">        Log.d(Constant.TAG, MessageFormat.format(<span class="string">"Thread[&#123;0&#125;]--myThreadHandler.Message.callback.run"</span>,  </div><div class="line">                Thread.currentThread().getName()));   </div><div class="line">    &#125;  </div><div class="line">&#125;);  </div><div class="line">myThreadHandler.sendMessage(msg);</div></pre></td></tr></table></figure>
<h3 id="2-使用Handler-post"><a href="#2-使用Handler-post" class="headerlink" title="2.使用Handler.post"></a>2.使用Handler.post</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">myThreadHandler.post(<span class="keyword">new</span> Runnable() &#123;  </div><div class="line">                      </div><div class="line">                    <span class="meta">@Override</span>  </div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line">                        Log.d(Constant.TAG, MessageFormat.format(<span class="string">"Thread[&#123;0&#125;]--myThreadHandler.Message.callback.run"</span>,  </div><div class="line">                                Thread.currentThread().getName()));   </div><div class="line">                    &#125;  </div><div class="line">                &#125;);</div></pre></td></tr></table></figure>
<p>注：对于Handler机制相关测试，我写了一个测试类：<br>链接：<a href="http://pan.baidu.com/s/1o61Vgnw" target="_blank" rel="external">http://pan.baidu.com/s/1o61Vgnw</a> 密码：hqkp</p>
<h3 id="3-Handler对Activity-finish影响。"><a href="#3-Handler对Activity-finish影响。" class="headerlink" title="3.Handler对Activity finish影响。"></a>3.Handler对Activity finish影响。</h3><p>在开发的过程中碰到一个棘手的问题，调用Activity.finish函数Acitivity没有执行生命周期的ondestory函数，后面查找半天是因为有一个handler成员，因为它有一个delay消息没有处理，调用 Activity.finish，Activity不会马上destory，所以记得在Ativity finish前清理一下handle中的未处理的消息，这样Activity才会顺利的destory。</p>
<h3 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h3><p><a href="http://blog.csdn.net/stonecao/article/details/6417364" target="_blank" rel="external">http://blog.csdn.net/stonecao/article/details/6417364</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/05/android_handler2/" data-id="cj4zx2khv0024qonhid36wfgw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/handle/">handle</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android_handler" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/05/android_handler/" class="article-date">
  <time datetime="2015-11-05T03:23:29.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/android/">android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/05/android_handler/">android中handler用法总结 (一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一、Handler的定义"><a href="#一、Handler的定义" class="headerlink" title="一、Handler的定义:"></a>一、Handler的定义:</h2><p>Handler主要接收子线程发送的数据,并用此数据配合主线程更新UI，用来跟UI主线程交互用。比如可以用handler发送一个message，然后在handler的线程中来接收、处理该消息，以避免直接在UI主线程中处理事务导致影响UI主线程的其他处理工作，Android提供了Handler作为主线程和子线程的纽带；也可以将handler对象传给其他进程，以便在其他进程中通过handler给你发送事件；还可以通过handler的延时发送message，可以延时处理一些事务的处理。</p>
<p>通常情况下，当应用程序启动时，Android首先会开启一个主线程(也就是UI线程),主线程为管理界面中的UI控件，进行事件分发。如果此时需要一个耗时的操作，例如:联网读取数据，或者读取本地较大的一个文件的时候，你不能把这些操作放在主线程中，如果你放在主线程中的话，界面会出现假死现象,如果5秒钟还没有完成的话，会收到Android系统的一个错误提示”强制关闭”。这个时候我们需要把这些耗时的操作，放在一个子线程中,因为子线程涉及到UI更新，但是当子线程中有涉及到操作UI的操作时，就会对主线程产生危险，也就是说，更新UI只能在主线程中更新，在子线程中操作是危险的。这个时候，Handler就出现了来解决这个复杂的问题，由于Handler运行在主线程中(UI线程中)，它与子线程可以通过Message对象来传递数据，这个时候，Handler就承担着接受子线程传过来的(子线程用sedMessage()方法传递)Message对象，(里面包含数据),把这些消息放入主线程队列中，配合主线程进行更新UI。</p>
<h2 id="二、Handler一些特点"><a href="#二、Handler一些特点" class="headerlink" title="二、Handler一些特点"></a>二、Handler一些特点</h2><p>handler可以分发Message对象和Runnable对象到主线程中,每个Handler实例,都会绑定到创建他的线程中(一般是位于主线程),也就是说Handler对象初始化后，就默认与对它初始化的进程的消息队列绑定，因此可以利用Handler所包含的消息队列，制定一些操作的顺序。</p>
<h2 id="三、Handler中分发消息的一些方法"><a href="#三、Handler中分发消息的一些方法" class="headerlink" title="三、Handler中分发消息的一些方法"></a>三、Handler中分发消息的一些方法</h2><ul>
<li>post(Runnable)</li>
<li>postAtTime(Runnable,long)</li>
<li><p>postDelayed(Runnable long)<br>(post类方法允许你排列一个Runnable对象到主线程队列中。)</p>
</li>
<li><p>sendEmptyMessage(int)</p>
</li>
<li>sendMessage(Message)</li>
<li>sendMessageAtTime(Message,long)</li>
<li>sendMessageDelayed(Message,long)<br>(sendMessage类方法, 允许你安排一个带数据的Message对象到队列中，等待更新。)</li>
</ul>
<h2 id="四、应用实例："><a href="#四、应用实例：" class="headerlink" title="四、应用实例："></a>四、应用实例：</h2><h3 id="1，传递Message。用于接受子线程发送的数据-并用此数据配合主线程更新UI。"><a href="#1，传递Message。用于接受子线程发送的数据-并用此数据配合主线程更新UI。" class="headerlink" title="1，传递Message。用于接受子线程发送的数据, 并用此数据配合主线程更新UI。"></a>1，传递Message。用于接受子线程发送的数据, 并用此数据配合主线程更新UI。</h3><p>在Android中，对于UI的操作通常需要放在主线程中进行操作。如果在子线程中有关于UI的操作，那么就需要把数据消息作为一个Message对象发送到消息队列中，然后，主线程用Handler中的handlerMessge方法处理传过来的数据信息，并操作UI。类sendMessage(Message msg)方法实现发送消息的操作。 在初始化Handler对象时重写的handleMessage方法来接收Messgae并进行相关操作。</p>
<h3 id="2，传递Runnable对象。用于通过Handler绑定的消息队列，安排不同操作的执行顺序。"><a href="#2，传递Runnable对象。用于通过Handler绑定的消息队列，安排不同操作的执行顺序。" class="headerlink" title="2，传递Runnable对象。用于通过Handler绑定的消息队列，安排不同操作的执行顺序。"></a>2，传递Runnable对象。用于通过Handler绑定的消息队列，安排不同操作的执行顺序。</h3><p>Handler对象在进行初始化的时候，会默认的自动绑定消息队列。利用类post方法，可以将Runnable对象发送到消息队列中，按照队列的机制按顺序执行不同的Runnable对象中的run方法。</p>
<p>另外，Android的CPU分配的最小单元是线程，Handler一般是在某个线程里创建的，因而Handler和Thread就是相互绑定的，一一对应。而Runnable是一个接口，Thread是Runnable的子类。所以说，他俩都算一个进程。</p>
<p> 示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;  </div><div class="line">      </div><div class="line">     <span class="comment">//声明两个按钮控件  </span></div><div class="line">     <span class="keyword">private</span> Button startButton = <span class="keyword">null</span>;  </div><div class="line">     <span class="keyword">private</span> Button endButton = <span class="keyword">null</span>;  </div><div class="line">     <span class="meta">@Override</span> </div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;  </div><div class="line">         <span class="keyword">super</span>.onCreate(savedInstanceState);  </div><div class="line">         setContentView(R.layout.main);  </div><div class="line">        <span class="comment">//根据控件的ID得到代表控件的对象，并为这两个按钮设置相应的监听器  </span></div><div class="line">        startButton = (Button)findViewById(R.id.startButton);  </div><div class="line">        startButton.setOnClickListener(<span class="keyword">new</span> StartButtonListener());  </div><div class="line">        endButton = (Button)findViewById(R.id.endButton);  </div><div class="line">        endButton.setOnClickListener(<span class="keyword">new</span> EndButtonListener());  </div><div class="line">          </div><div class="line">    &#125;  </div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">StartButtonListener</span> <span class="keyword">implements</span> <span class="title">OnClickListener</span></span>&#123;  </div><div class="line"> </div><div class="line">        <span class="meta">@Override</span> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;  </div><div class="line">            <span class="comment">//调用Handler的post方法，将要执行的线程对象添加到队列当中  </span></div><div class="line">            handler.post(updateThread);  </div><div class="line">        &#125;  </div><div class="line">         </div><div class="line">    &#125;  </div><div class="line">      </div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">EndButtonListener</span> <span class="keyword">implements</span> <span class="title">OnClickListener</span></span>&#123;  </div><div class="line"> </div><div class="line">        <span class="meta">@Override</span> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;  </div><div class="line">            handler.removeCallbacks(updateThread);  </div><div class="line">        &#125;  </div><div class="line">          </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//创建一个Handler对象  </span></div><div class="line">    Handler handler  = <span class="keyword">new</span> Handler();  </div><div class="line">    <span class="comment">//将要执行的操作写在线程对象的run方法当中  </span></div><div class="line">    Runnable updateThread =  <span class="keyword">new</span> Runnable()&#123;  </div><div class="line"> </div><div class="line">        <span class="meta">@Override</span> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </div><div class="line">            System.out.println(<span class="string">"UpdateThread"</span>);  </div><div class="line">            <span class="comment">//在run方法内部，执行postDelayed或者是post方法  </span></div><div class="line">            handler.postDelayed(updateThread, <span class="number">3000</span>);  </div><div class="line">        &#125;  </div><div class="line">          </div><div class="line">    &#125;;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>程序的运行结果就是每隔3秒钟，就会在控制台打印一行UpdateTread。这是因为实现了Runnable接口的updateThread对象进入了空的消息队列即被立即执行run方法，而在run方法的内部，又在3000ms之后将其再次发送进入消息队列中。</p>
<h3 id="3，-Handler和多线程"><a href="#3，-Handler和多线程" class="headerlink" title="3， Handler和多线程"></a>3， Handler和多线程</h3><p>post方法虽然发送的是一个实现了Runnable接口的类对象，但是它并非创建了一个新线程，而是执行了该对象中的run方法。也就是说，整个run中的操作和主线程处于同一个线程。这样对于那些简单的操作，似乎并不会影响。但是对于耗时较长的操作，就会出现“假死”。为了解决这个问题，就需要使得handler绑定到一个新开启线程的消息队列上，在这个处于另外线程的上的消息队列中处理传过来的Runnable对象和消息。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerTest2</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;  </div><div class="line">  </div><div class="line">     <span class="meta">@Override</span> </div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;  </div><div class="line">         <span class="comment">// TODO Auto-generated method stub  </span></div><div class="line">     <span class="keyword">super</span>.onCreate(savedInstanceState);  </div><div class="line">     setContentView(R.layout.main);  </div><div class="line">     <span class="comment">//打印了当前线程的ID  </span></div><div class="line">     System.out.println(<span class="string">"Activity--&gt;"</span> + Thread.currentThread().getId());  </div><div class="line">    <span class="comment">//生成一个HandlerThread对象  </span></div><div class="line">    HandlerThread handlerThread = <span class="keyword">new</span> HandlerThread(<span class="string">"handler_thread"</span>);  </div><div class="line">    <span class="comment">//在使用HandlerThread的getLooper()方法之前，必须先调用该类的start()，同时开启一个新线程;  </span></div><div class="line">    handlerThread.start();</div><div class="line">    <span class="comment">//将由HandlerThread获取的Looper传递给Handler对象，即由处于另外线程的Looper代替handler初始化时默认绑定的消息队列来处理消息。  </span></div><div class="line">    <span class="comment">// HandlerThread顾名思义就是可以处理消息循环的线程，它是一个拥有Looper的线程</span></div><div class="line">    <span class="comment">//，可以处理消息循环；  其实与其说Handler和一个线程绑定，倒不如说Handler和Looper是</span></div><div class="line">    <span class="comment">//一一对应的。</span></div><div class="line">    MyHandler myHandler = <span class="keyword">new</span> MyHandler(handlerThread.getLooper());  </div><div class="line">    Message msg = myHandler.obtainMessage();  </div><div class="line">    <span class="comment">//将msg发送到目标对象，所谓的目标对象，就是生成该msg对象的handler对象  </span></div><div class="line">    Bundle b = <span class="keyword">new</span> Bundle();  </div><div class="line">    b.putInt(<span class="string">"age"</span>, <span class="number">20</span>);  </div><div class="line">    b.putString(<span class="string">"name"</span>, <span class="string">"Jhon"</span>);  </div><div class="line">    msg.setData(b);  </div><div class="line">    msg.sendToTarget();  <span class="comment">//将msg发送到myHandler</span></div><div class="line">    &#125;  </div><div class="line">      </div><div class="line">    <span class="comment">//定义类</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>&#123;  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyHandler</span><span class="params">()</span></span>&#123;  </div><div class="line">              </div><div class="line">    &#125;  </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyHandler</span><span class="params">(Looper looper)</span></span>&#123;  </div><div class="line">        <span class="keyword">super</span>(looper);  </div><div class="line">    &#125;  </div><div class="line">    <span class="meta">@Override</span> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;  </div><div class="line">        Bundle b = msg.getData();  </div><div class="line">        <span class="keyword">int</span> age = b.getInt(<span class="string">"age"</span>);  </div><div class="line">        String name = b.getString(<span class="string">"name"</span>);  </div><div class="line">        System.out.println(<span class="string">"age is "</span> + age + <span class="string">", name is"</span> + name);  </div><div class="line">        System.out.println(<span class="string">"Handler---&gt;"</span> + Thread.currentThread().getId());  </div><div class="line">        System.out.println(<span class="string">"handlerMessage"</span>);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样，当使用sendMessage方法传递消息或者使用post方法传递Runnable对象时，就会把它们传递到与handler对象绑定的处于另外一个线程的消息队列中，它们将在另外的消息队列中被处理。而主线程还会在发送操作完成时候继续进行，不会影响当前的操作。<br>这里需要注意，这里用到的多线程并非由Runnable对象开启的，而是ThreadHandler对象开启的。Runnable对象只是作为一个封装了操作的对象被传递，并未产生新线程。<br>另外再强调一遍，在UI线程（主线程）中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mHandler=<span class="keyword">new</span> Handler();</div><div class="line">mHandler.post(<span class="keyword">new</span> Runnable()&#123;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">   <span class="comment">//执行代码..</span></div><div class="line"> &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这个线程其实是在UI线程之内运行的，并没有新建线程。</p>
<p>常见的新建线程的方法是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Thread thread = <span class="keyword">new</span> Thread();</div><div class="line">thread.start();</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">HandlerThread thread = <span class="keyword">new</span> HandlerThread(<span class="string">"string"</span>);</div><div class="line">thread.start();</div></pre></td></tr></table></figure>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="http://blog.sina.com.cn/s/blog_77c6324101016jp8.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_77c6324101016jp8.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/05/android_handler/" data-id="cj4zx2khu0021qonhxrjcjzsz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/handler/">handler</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-movie_shanheguren" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/05/movie_shanheguren/" class="article-date">
  <time datetime="2015-11-05T01:23:29.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/电影/">电影</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/05/movie_shanheguren/">贾樟柯说，我的电影无暇顾及中国牛不牛逼</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[转自端传媒 撰稿人 廖伟棠]</p>
<p>港产江湖片透露出來的情义，变成了我们这一代人的情感追求。我的工作不是要拍中国牛逼，也不是要拍中国不牛逼。我的全部注意力都在人们的命运上，都在人们的情感生活上，是人在迁移。</p>
<p>导演贾樟柯又出新片了！《山河故人》是他在《三峡好人》之後又一部终於能在商业院线上映的电影。《山河故人》既是现实主义的， 又是科幻的现实。它既被誉为2015年度最有深度的情感片，又招来影迷两极化的评论。趁贾樟柯和《山河故人》团队今次应香港亚洲电影节邀请，来港出席开幕 礼兼宣传的时机，作家廖伟棠和贾樟柯聊一聊——这部电影怎样呈现了贾樟柯对中国人命运的独特理解，对中国未来的预测，而香港这个城市，怎样隐秘而深久地参 与了他和这部电影的精神世界。<br><img src="https://d3rhr7kgmtrq1v.cloudfront.net/media/290cabef981f4b0e8a6fbc770132ca45.jpg?imageView2/1/w/1080/h/720/format/jpg" alt="贾樟柯"><br> 《山河故人》导演贾樟柯。摄：王嘉豪/端传媒 </p>
<p>廖：《山河故人》比起《天注定》有一个比较明显的反差，首先是全底层的关注角度转向更多其他阶层、尤其是新贵的关注，而对富裕阶层的剖析也不止于批判，有更复杂的认识在 里面，是什么原因促使你加强对后者的观察与呈现的呢？<br>我记得十年前采访你，你说你广泛结交各阶层的朋友，是否十年来的酝酿终于可以结果？为何在现在这个时机拿出来，呈现一个富人的选择？</p>
<h2 id="我一直在感受人与人之间的分化"><a href="#我一直在感受人与人之间的分化" class="headerlink" title="我一直在感受人与人之间的分化"></a>我一直在感受人与人之间的分化</h2><p>贾：从写剧本说起吧，我写剧本不会有过多大纲性的规划，都是信马由缰，写到他们仨的关系确立的时候我自己吓了一 跳，怎么写了一个三角关系？我有点想否定它想重写，但后来又想，我为什么从感性出发写了一个三角关系？我突然发现这关系的出现是对的，我这些年感受到生活 里很多同一起点的人，怎么样在这个中国社会的变革中被分化了。他们过去本来同属一个阶层、一个地方，本来差异很少，但随着不同的道路，每人拥有不同的资 源，他们就开始分化，且越来越大。<br>最后形成一个个阶层的固化，过去一个班的同学可能很难再坐在一个桌子吃饭了。以我一个老朋友为例，我拍《天注定》的时候，我们之前一直有来往，也知 道他富有了，但不知道他富有到什么程度。当时我们要拍一架飞机落地的镜头，剧组一直在联系飞机，他在旁边听到笑了，说找我嘛，我有三架飞机，平时停在香 港，你需要的话我就给你调一架过来。</p>
<blockquote>
<p>命运是一样的，并不会因为拥有更多财富就拥有更多自由和自主权。</p>
</blockquote>
<p>这种反差是非常大的，我一直在感受人与人之间的分化。其实它也是我的现实的一部分，我的朋友两边都有、都没有失去联络，这两年山西的新富阶层突然有 一个命运的转折，他们又跟起点上的人一样，要跑路、要从头开始了。你会发现命运是一样的，并不会因为拥有更多财富就拥有更多自由和自主权。我不去做道德评 判，只是这个落差的现实使我感兴趣。最好笑的是很多朋友会躲到四季酒店住很久，其实他没事，就是怕。</p>
<p>廖：和《天注定》里那些底层反抗者相比，梁子更多选择了认命，在第三个时期故事里压根没有了他的存在，好像在说未来没有底层的生存空间一样，这是你故意这样做的吗？是否拍摄《天注定》带来的绝望感，感受到这种抗争的不可为。<br><img src="https://d3rhr7kgmtrq1v.cloudfront.net/media/763bf19b9e8141adac228da176723df7.jpg?imageView2/1/w/1080/h/720/format/jpg" alt="花絮"><br> 贾樟柯电影《山河故人》拍摄花絮。 </p>
<h2 id="人其实并不知道自己的结局是怎样的"><a href="#人其实并不知道自己的结局是怎样的" class="headerlink" title="人其实并不知道自己的结局是怎样的"></a>人其实并不知道自己的结局是怎样的</h2><p>贾：其实和抗争无关，我笔下的人物一般都没有超越自己真实的处境，或者说我比较喜欢他们这样。大多数人其实并不 知道自己的结局是怎样的，结局出现才会明白。像梁子他离开故乡的时候，他不一定是绝望的，只是有情伤而已，他为此离开。但他没想到自己一步步陷入更糟糕的 处境，他本来是“井上”负责发矿灯的，后来变成“井下”的了。我喜欢不自知的人物，他们对现实没有自知的反应，大多数人都是这样的。<br>第三部分完全没有拍过梁子的戏份，其中有几个因素：99年到14年，他们都有一个断裂，比如说只字不提沈涛和晋生为什么离婚，因为我觉得情感上这种 分离太可以理解了，我们可以有无数种想像他们之间发生了什么。另外梁子他已经要化疗了，那么重的病，最终人可能就没了，没有了也就没有了，生活就是这么残 酷的。</p>
<p>廖：未来好像没有了他那一阶层的位置。</p>
<p>贾：晋生的上海老婆也是，我想像过她也可能跑掉了。</p>
<p>廖：跟梁子的老婆形成对比，梁子的老婆是跟他共患难的，晋生的上海老婆却只能同富贵。</p>
<p>贾：我觉得也是。</p>
<p>廖：你写剧本就这么开放吗？有的导演是事后剪掉很多东西形成留白的。</p>
<blockquote>
<p>因为她恒定，就像故乡一样，最能映衬飘泊。</p>
</blockquote>
<p>贾：我不是，我在写的时候就觉得不应该写它，我需要一个很大的留白就是14年到25年，这之间发生了什么？关于 过去我们可以留白，因为留白的前提是我们经历过，像99年到14年那样，我们可以用经验来填补。14年到25年在这个结构上是一个很重要的空隙，它不是留 白是空隙。我们一年年的度过，2016年会怎样，大家可以想像吗？</p>
<p>廖：你的电影的时间线跟现实的时间线有一点相像，就是越来越急促、越来越紧迫，这种紧迫感，造成一种心情越来越沉重的感觉。<br>父亲的去世是沈涛真正的转折点，在经历丧夫失子之痛后，她选择的也是一种接受命运的态度，她与晋生对命运态度截然不同，与梁子仿佛殊途同归，这是否导演情感上对失败者的一种默默倾斜。</p>
<p>贾：当然沈涛是电影最中心的人物，她是唯一没有离开的人。我们说这些年外在的飘泊是电影的一个主题，但对沈涛来 说更大的一个飘泊是情感上的，因为她恒定，就像故乡一样，最能映衬飘泊。如果你在故乡一直生活，你就能看到总是有人离开有人回来，所以她像一个人心的站台 一样。她的内心因为人来人往而被拉扯得更厉害。</p>
<p>廖：最后的镜头是非常感人的，听到儿子的一声呼唤，可以是幻听，也可以是真的有这么一个声音。<br>科幻的部分我自己特别喜欢，在没看电影前我最担心的就是这个部分，因为中国导演处理科幻要么特别过火要么特别土，但你非常克制，跟现实的藕断丝连看得人会心一笑。正因为这种克制，连张艾嘉的忘年恋我也看得非常自然。<br>在对中国现况和未来图景的描述上，你也选择了最大的中立和克制，把批评压抑在叙事底下，但即使如此还是有很多观众说你在黑中国，你想辩白一下吗？<br><img src="https://d3rhr7kgmtrq1v.cloudfront.net/media/0f980c5d514c45db983a577ecaff4d9c.jpg?imageView2/1/w/1080/h/720/format/jpg" alt="剧照"><br> 电影《山河故人》剧照。</p>
<h2 id="时代的准确性应该存在模糊"><a href="#时代的准确性应该存在模糊" class="headerlink" title="时代的准确性应该存在模糊"></a>时代的准确性应该存在模糊</h2><blockquote>
<p>我的工作不是要拍中国牛逼，也不是要拍中国不牛逼。我的全部注意力都在人们的命运上，都在人们的情感生活上，是人在迁移。</p>
</blockquote>
<p>贾：最早说《山河故人》在黑中国的，实际是康城的几个中国留学生，他们当时在电影节看到反应就比较激烈，当时我 就觉得很搞笑，我拍电影不是为了给谁面子的（他们觉得很没面子）。事实上在我拍电影的时候，我觉得中国牛逼不牛逼跟我没有任何关系，我的工作不是要拍中国 牛逼，也不是要拍中国不牛逼。我的全部注意力都在人们的命运上，都在人们的情感生活上，是人在迁移。<br>关于未来的部分，一开始我的思路也有走偏过，我曾经想把它拍得特别科幻，比如说到乐会爱上一个外星人，那个外星人没有性别，比较为难，怎么跟它做爱 呢？后来还是从生活经验出发，我突然想到一个东西，这个时间点不过是十年后，十年是近未来而已，比如说今年买的一辆车，保养得好的话25年还会在街上走， 所以不应该是那种颠覆性的科幻世界。另一方面我觉得可变的东西里电子产品是比较重要的，因为它一直在迅速更新，我都嫌我自己对电影里的电子通讯产品设计得 有点保守，应该再更超现实一点。<br>但也有往回走的，比如说他们还在开六十年代澳洲流行的车，还听黑胶唱片，这就跟我们现在有人玩古家具一样。我喜欢这种混杂的感觉，这有点像拍《站 台》时的经验，《站台》的十年是中国巨变的十年，城市外观和衣着都变化极大，我设计第一稿的时候，每到一年人物的衣着都要全部变掉，中山装时代、风衣时 代、西装时代、夹克时代……但后来发现这是导演的主观，为了强调时代跨越，你仔细看那时候的纪实照片会发现时代实际上是混杂的，到了夹克时代一样有人在穿 中山装。对我来说，时代的准确性应该存在模糊，而不是存在刻意的时代区分，所以未来部分也让他混合起来。</p>
<blockquote>
<p>“个人的解放”其实还是中国人的一个很重要的事情，是还要去做的，所以我想像了他的未来。</p>
</blockquote>
<p>廖：涉及反贪的部分是怎样过审的，现在播出版本和最初版本相比删节大吗？</p>
<p>贾：审查真没有问题，唯一的是忘年恋那处有一个接吻镜头，他们建议我剪掉，但在我的坚持下也没有剪。据我所知，这电影在审查的时候，审查员很多都哭了，他们被感动了。现在的版本和海外电影节版本是一模一样的，一刀没剪。</p>
<p>廖：你一直对类型片有很大兴趣，这次的三分一部科幻片出乎意料，但又很克制，让人觉得还是贾樟柯签名式的，拿捏得宜，感觉是现实主义的未来。以后还想拍科幻题材吗？会更直接天马行空吗？</p>
<p>贾：其实我对科幻片兴趣不大，只是在我写剧本写到当代部分的时候，我觉得那个孩子的未来我应该想下去，因为他那 么小，命运像被上一代人决定了，父母离婚、移民、抚养权什么他都没有发言权，我就想他长大以后有没有自由，能否自己做主，在生活和情感领域他有没有一个自 我解放，可以说这才是我一直着迷的、人的话题。“个人的解放”其实还是中国人的一个很重要的事情，是还要去做的，所以我想像了他的未来。我个人最着迷的类 型片是黑帮片、武侠片，它跟我的性格更贴切一些。<br><img src="https://d3rhr7kgmtrq1v.cloudfront.net/media/b0ffa0885fa34c9a96b99ec8926a5872.jpg?imageView2/1/w/1080/h/720/format/jpg" alt="贾樟柯"><br> 《山河故人》导演贾樟柯。摄：王嘉豪/端传媒</p>
<h2 id="港产片里的情义成了我这代人的情感追求"><a href="#港产片里的情义成了我这代人的情感追求" class="headerlink" title="港产片里的情义成了我这代人的情感追求"></a>港产片里的情义成了我这代人的情感追求</h2><p>廖：那么传说中的武侠片《在清朝》怎样了？</p>
<p>贾：《在清朝》真的要拍了，筹备七年了，剧本早就完成，忙完《山河故人》就马上开工拍。我们的美术设计也完成，就差服装设计了，因为演员没定下，服装才没动。</p>
<p>廖：以前你还说过想拍一个以香港为背景的间谍片呢？</p>
<p>贾：那是《双雄会》，《双雄会》有重大进展，它刚刚确定了制片人，我会跟英国的Jimmy Thomas（《末代皇帝》的制片人）合作。</p>
<p>廖：那里面的香港与《山河故人》里作为潜台词的香港应该是很不一样的。</p>
<blockquote>
<p>我一直喜欢听叶倩文的歌就是因为她有情有义，这几年很多情歌，但义却很薄了。</p>
</blockquote>
<p>贾：不一样，香港在那个电影里面是一个交叉路口，人们必须经过的一个地方，各种离散的人，无论往大陆走还是往台湾走还是待在香港观望。<br>廖：这是《双雄会》的设定，实际上《山河故人》里面香港也是这么一个出发点吧，香港以潜台词的形式出现在山河故 人，但无论是《珍重》还是张艾嘉的角色都好像寄情甚深，欲言又止。你曾在一个电影节开幕式提到“情义”，我觉得这正是香港电影的核心价值，它是怎样作用于 你和你的电影的？</p>
<p>贾：某种程度上八十年代大陆开始进入录像厅时代那时的香港电影，如江湖片，它透露出来的情义，变成了我们这一代人的情感追求，让我们变得特别看重情感里面情义相连的部分。至于说过去大陆电影有没有我倒不知道，反正我们是在录像厅里知道这种情义的。<br>从流行音乐来看，我一直喜欢听叶倩文的歌就是因为她有情有义，这几年很多情歌，但义却很薄了，情义相连这个概念跟关公也很有关系，最初的时候我对情 义二字也没有掰开看，直到有一次在山西一个武术家跟我聊天，他说关公跟曹操是有义无情，跟刘备才是有情有义，我才知道情义是可以掰开来说的。就像你说的， 情义是港产片里很吸引人的核心价值。<br><img src="https://d3rhr7kgmtrq1v.cloudfront.net/media/895435edd7f44357a9ff1050b3fd8325.jpg?imageView2/1/w/1080/h/720/format/jpg" alt="花絮"><br> 贾樟柯电影《山河故人》拍摄花絮。 </p>
<h2 id="时间让我们变成了古人"><a href="#时间让我们变成了古人" class="headerlink" title="时间让我们变成了古人"></a>时间让我们变成了古人</h2><p>廖：目前对山河、故人的诠释，你最喜欢哪一种。 正如山河有对山西山河的呼应；我更关心的是故人，前阵子有位编剧柏邦妮说：故人就是过去价值观的褒有者，我非常同意。故人是否也呼应你自己某种私人记忆和 情感，感觉很沉郁，这次你自己以什么方式折射其中呢？我第一次听到这个名字，想到的是梅艳芳的《似是故人来》，它就像这部电影的一个没出现的配乐。</p>
<p>贾：在梁子身上，你会发现他是一个有古意的人，我这部电影的情感方法其实也挺古意的，它对我来说也许是失散的、丢失的东西。时间让我们变成了古人，故人本身也有失散的、离别的含义在里面。很复杂的一种感情。</p>
<blockquote>
<p>生活解构了她的幻想，她年轻时还可以编出几句好词，但当时间告诉了她生活是怎么个样子的时候，她就把这样一个幻想解构掉了。</p>
</blockquote>
<p>廖：但最后实际上大多数的相会都没有完成，沈涛与梁子重遇时没有一个很动情的刹那，跟儿子也没有真正重逢，这个留白是你不确定呢还是故意的？<br>贾：并非不确定，我一直是在按正常的人在情感情景中的反应去体会人物。涛跟梁子的再次相遇的时候，对我来说中心 词是“再也写不出那个好词了”。因为梁子问她你还唱“伞头”吗？“伞头”秧歌在我们那边是即兴表演的，给你出一个题目你就要马上编成四句八句。这里的沧桑 感在于生活解构了她的幻想，她年轻时还可以编出几句好词，但当时间告诉了她生活是怎么个样子的时候，她就把这样一个幻想解构掉了。<br>这电影里的时间始终处于一个解构的过程中，14年是对99年的解构，25年是对14年的解构。这不是一个理性的想法，而是时间交给我们的东西，就像隔夜茶一样，转眼味道就变了。<br>总体上来说，这个电影重情重义，拍得也动情动心，所以根本无暇去想中国牛逼不牛逼的问题，只能说他们想多了。</p>
<p>鸣谢访问场地提供︰尖沙嘴隆堡丽景酒店AVA Restaurant Slash Bar</p>
<h2 id="山河故人"><a href="#山河故人" class="headerlink" title="山河故人"></a>山河故人</h2><p>导演/编剧 : 贾樟柯<br>演员 : 赵涛、张艾嘉、董子健、张译、梁景东<br>片长 : 126 分钟<br>剧情简介：1999年，小城汾阳，涛儿徘徊在煤矿老板晋生和矿工梁子的三角关系之中，在新世纪来临前，涛儿选择嫁给晋生，梁子远走他 乡。2014年，梁子重病缠身，离家15年后带着妻儿回到故乡，等待生命最后一刻的停摆；病床前涛儿与梁子相望唏嘘，涛儿已经离婚，前夫晋生准备带儿子移 民澳洲。2025年，涛的儿子长大成人，住在澳洲A城，他不讲中文，只记得母亲的名字叫：Tao，波浪的意思。横越三十年，山河不再，人面亦非。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/05/movie_shanheguren/" data-id="cj4zx2kjl0053qonh4cn0e7rr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/电影/">电影</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/贾樟柯/">贾樟柯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-database_ORMLite_and_GreenDao" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/04/database_ORMLite_and_GreenDao/" class="article-date">
  <time datetime="2015-11-04T12:27:29.000Z" itemprop="datePublished">2015-11-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/04/database_ORMLite_and_GreenDao/">SQLite数据库框架ORMLite与GreenDao的简单比较</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="笔记摘要"><a href="#笔记摘要" class="headerlink" title="笔记摘要"></a>笔记摘要</h3><p>最近准备使用数据库做个缓存，以前因为项目中的实时性要求比较高，所以在整体的框架中就没有加缓存，有些地方只是简单的将对象保存到了 Preference中，所以并没有对数据库方面有所研究，既然准备使用数据库了，那就深入了解下吧，对以后也有好处。现在开源社区也有很多的ORM框 架，但不知道哪个好用些，所以就上网查了一下，简单的总结了下，现在分享给大家。</p>
<p>先介绍一下ORM的概念，以前也一直听说，不过没详细了解啥意思。其全称叫做对象关系映射（Object Relation Mapping），是一种程序设计技术，用于实现面向对象编程语言里不同类型系统的数据之间的转换。从效果上说，它其实是创建了一个可在编程语言里使用的 “虚拟对象数据库”。<br>面向对象是从软件工程基本原则(如耦合、聚合、封装)的基础上发展起来的，而关系数据库则是从数学理论发展而来的.  两者之间是不匹配的.而ORM作为项目中间件形式实现数据在不同场景下数据关系映射. 对象关系映射是一种为了解决面向对象与关系数据库存在的互不匹配的现象的技术.ORM就是这样而来的。</p>
<p>下面先列出几个ORM框架：ORMLite、greendao、ormndroid、androrm、ActiveAndroid<br>其中以前最早接触过ormlite，GreenDao了解过，其他的几个真没怎么见过。所以这里主要介绍ormlite和GreenDao。<br>最开始现在stackoverflow输入sqlite orm关键字，搜索出了一些相关的文章：<a href="http://stackoverflow.com/search?q=sqlite+orm" target="_blank" rel="external">http://stackoverflow.com/search?q=sqlite+orm</a> ，你会发现很有趣的是，ormlite的作者Gray和greenDao的开发团队green robot同时出现在一些帖子中，向提问者推荐他们的框架。当然也会有一些热心的朋友推荐ormdroid。其实不论在stackoverflow上还是官网上，greenDao的团队的比较都是针对ORMLite的，可见，其主要的竞争对手，或许称互相促进者更合适，毕竟他们没有什么商业利益，完全开源。所以开源的ORM框架中，ormLite和greenDao是最火的。其它几种就不做比较，有兴趣的朋友可以到官网看下。下面对ORMLite和GreenDao做个简单的比较：</p>
<h3 id="ormlite"><a href="#ormlite" class="headerlink" title="ormlite"></a>ormlite</h3><p>基于注解和反射的的方式,导致ormlite性能有着一定的损失(注解其实也是利用了反射的原理)</p>
<h4 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h4><ul>
<li>文档较全面，社区活跃，有好的维护，使用简单，易上手。<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4></li>
<li>基于反射，效率较低</li>
</ul>
<h3 id="GreenDao"><a href="#GreenDao" class="headerlink" title="GreenDao"></a>GreenDao</h3><p>官网中明确指明了其首要设计目标:</p>
<ul>
<li>Maximum performance (probably the fastest ORM for Android):系能最大化</li>
<li>Easy to use APIs：便于使用</li>
<li>Highly optimized for Android：对于Android高度优化</li>
<li>Minimal memory consumption：最小化内存开销</li>
<li>Small library size, focus on the essentials：较小的文件体积，只集中在必要的部分上。</li>
</ul>
<h4 id="优点：-1"><a href="#优点：-1" class="headerlink" title="优点："></a>优点：</h4><ul>
<li>效率很高，插入和更新的速度是sqlite的2倍，加载实体的速度是ormlite的4.5倍。官网测试结果：<a href="http://greendao-orm.com/features/" target="_blank" rel="external">http://greendao-orm.com/features/</a></li>
<li>文件较小（&lt;100K），占用更少的内存 ，但是需要create Dao，</li>
<li>操作实体灵活：支持get，update，delete等操作</li>
</ul>
<h4 id="缺点：-1"><a href="#缺点：-1" class="headerlink" title="缺点："></a>缺点：</h4><p>学习成本较高。其中使用了一个java工程根据一些属性和规则去generate一些基础代码，类似于javaBean但会有一些规则，另外还有QueryBuilder、Dao等API，所以首先要明白整个过程，才能方便使用。没有ORMLite那样封装的完整，不过greenDao的官网上也提到了这一点，正是基于generator而不是反射，才使得其效率高的多。</p>
<p>另外GreenDao支持Protocol buffers协议数据的直接存储 ，如果通过protobuf协议和服务器交互，不需要任何的映射。</p>
<p>Protocol Buffers协议：以一种高效可扩展的对结构化数据进行编码的方式。google内部的RPC协议和文件格式大部分都是使用它。<br>RPC：远程过程调用（Remote Procedure Call，RPC）是一个计算机通信协议，它是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。</p>
<p>可能因为GreenDao的效率高，而且需要学习成本高点，所以个人还是有兴趣学一学的。接下来会发布一些GreenDao更详细的文章，有对官方文档的翻译还有代码的简单讲解。<br>或许以上内容很简单，只是简单的介绍了下，对其它几个框架并没有做更多的介绍，有了解的朋友可以提出来，可以提出来，大家一起探讨下。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/04/database_ORMLite_and_GreenDao/" data-id="cj4zx2kjl004rqonhx05xrz1x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GreenDao/">GreenDao</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ORMLite/">ORMLite</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-tools_java_code_templates" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/04/tools_java_code_templates/" class="article-date">
  <time datetime="2015-11-04T12:22:29.000Z" itemprop="datePublished">2015-11-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tools/">tools</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/04/tools_java_code_templates/">java编程代码样式的xml模板</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前言：编码的规范性便于自己和他人后续对代码的维护和更新，现在贴一份codetemplates.xml的模板样式，在eclipse中可以导入使用。</p>
<h3 id="参考如下："><a href="#参考如下：" class="headerlink" title="参考如下："></a>参考如下：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;<span class="tag">&lt;<span class="name">templates</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"true"</span> <span class="attr">context</span>=<span class="string">"filecomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for created Java files"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.filecomment"</span> <span class="attr">name</span>=<span class="string">"filecomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> * </div><div class="line"> * @author aresxiong</div><div class="line"> * @date $&#123;date&#125;</div><div class="line"> * @Copyright: Copyright (c) $&#123;year&#125; JIUDU Technology All rights reserved.</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"false"</span> <span class="attr">context</span>=<span class="string">"fieldcomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for fields"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.fieldcomment"</span> <span class="attr">name</span>=<span class="string">"fieldcomment"</span>&gt;</span></div><div class="line"> /** */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"false"</span> <span class="attr">context</span>=<span class="string">"typecomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for created types"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.typecomment"</span> <span class="attr">name</span>=<span class="string">"typecomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> * </div><div class="line"> * @author aresxiong</div><div class="line"> * @date $&#123;date&#125;</div><div class="line"> * @Copyright: Copyright (c) $&#123;year&#125; JIUDU Technology All rights reserved.</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"true"</span> <span class="attr">context</span>=<span class="string">"overridecomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for overriding methods"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.overridecomment"</span> <span class="attr">name</span>=<span class="string">"overridecomment"</span>&gt;</span></div><div class="line">/* (non-Javadoc)</div><div class="line"> * $&#123;see_to_overridden&#125;</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"true"</span> <span class="attr">context</span>=<span class="string">"settercomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for setter method"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.settercomment"</span> <span class="attr">name</span>=<span class="string">"settercomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> * @param  $&#123;param&#125;</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"true"</span> <span class="attr">context</span>=<span class="string">"gettercomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for getter method"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.gettercomment"</span> <span class="attr">name</span>=<span class="string">"gettercomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> * @return the $&#123;bare_field_name&#125;</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"false"</span> <span class="attr">context</span>=<span class="string">"methodcomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for non-overriding methods"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.methodcomment"</span> <span class="attr">name</span>=<span class="string">"methodcomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> *</div><div class="line"> * @version 1.0</div><div class="line"> * @createTime $&#123;date&#125;,$&#123;time&#125;</div><div class="line"> * @createAuthor aresxiong</div><div class="line"> * @updateInfo ()</div><div class="line"> * $&#123;tags&#125;</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"true"</span> <span class="attr">context</span>=<span class="string">"constructorcomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for created constructors"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.constructorcomment"</span> <span class="attr">name</span>=<span class="string">"constructorcomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> *</div><div class="line"> * @version 1.0</div><div class="line"> * @createTime $&#123;date&#125;,$&#123;time&#125;</div><div class="line"> * @createAuthor aresxiong</div><div class="line"> * @updateInfo ()</div><div class="line"> * $&#123;tags&#125;</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">autoinsert</span>=<span class="string">"true"</span> <span class="attr">context</span>=<span class="string">"delegatecomment_context"</span> <span class="attr">deleted</span>=<span class="string">"false"</span> <span class="attr">description</span>=<span class="string">"Comment for delegate methods"</span> <span class="attr">enabled</span>=<span class="string">"true"</span> <span class="attr">id</span>=<span class="string">"org.eclipse.jdt.ui.text.codetemplates.delegatecomment"</span> <span class="attr">name</span>=<span class="string">"delegatecomment"</span>&gt;</span></div><div class="line">/**</div><div class="line"> *</div><div class="line"> * @version 1.0</div><div class="line"> * @createTime $&#123;date&#125;,$&#123;time&#125;</div><div class="line"> * @createAuthor aresxiong</div><div class="line"> * @updateInfo ()</div><div class="line"> * $&#123;tags&#125;</div><div class="line"> */</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">templates</span>&gt;</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/04/tools_java_code_templates/" data-id="cj4zx2kkn006iqonhoknle608" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/eclipse/">eclipse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/templates/">templates</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android_pulltorefresh_listview" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/04/android_pulltorefresh_listview/" class="article-date">
  <time datetime="2015-11-04T00:55:29.000Z" itemprop="datePublished">2015-11-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/android/">android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/04/android_pulltorefresh_listview/">PullToRefresh使用详解（一）--构建下拉刷新的listView</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前几天写了篇关于 PullToRefresh控件的DEMO导入的博客，但由于当时没有用到，所以就没细往下讲，现在开始到了实战阶段，用到了PullToRefresh 的listView样式，网上有讲的，但讲的不多，而且没有详细的例子来说，下面我讲讲这个东东的实现方法。这个例子对应 PullToRefreshDemo里的第一个选项ListView；</p>
<p>注意：本篇仅写的如何实现下拉刷新，对于上拉加载的问题，参见《使用PullToRefresh实现下拉刷新和上拉加载》</p>
<p>相关文章：</p>
<ul>
<li><a href="http://blog.csdn.net/harvic880925/article/details/17258789" target="_blank" rel="external">1、《List控件使用–SimpleAdapter使用详解（一）》</a></li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/17288687" target="_blank" rel="external">2、《List控件使用–SimpleAdapter使用详解（二）》</a></li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/17708409" target="_blank" rel="external">3、《PullToRefresh使用详解(二)—重写BaseAdapter实现复杂XML下拉刷新》</a></li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/17789617" target="_blank" rel="external">4、《PullToRefresh使用详解（三）–实现异步加载的下拉刷新列表》</a></li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/17792755" target="_blank" rel="external">5、《PullToRefresh使用详解（四）–利用回调函数实现到底加载》</a></li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/24722657" target="_blank" rel="external">6、《PullToRefresh使用详解（五）–下拉刷新的ScrollView》</a></li>
</ul>
<h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图:"></a>效果图:</h3><p><img src="http://img.blog.csdn.net/20131230141828875?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGFydmljODgwOTI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br><img src="http://img.blog.csdn.net/20131230141834859?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGFydmljODgwOTI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<h3 id="一、导入Library"><a href="#一、导入Library" class="headerlink" title="一、导入Library"></a>一、导入Library</h3><p>下载<a href="https://github.com/chrisbanes/Android-PullToRefresh" target="_blank" rel="external">源码</a>后，里面有个Library工程，添加工程到Eclipse中。</p>
<p>另外extras文件夹还有两个工程：PullToRefreshListFragment和PullToRefreshViewPager，由于我们的这个用不到他们的库文件，所以不必导入了；<br><img src="http://img.blog.csdn.net/20131230143326000?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGFydmljODgwOTI1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<h3 id="二、实战"><a href="#二、实战" class="headerlink" title="二、实战"></a>二、实战</h3><p><strong> 1、新建工程，添加Libray库到工程中</strong><br>新建工程（try_PullToRefresh）后，右键-》Properties-》Android-》Add  选择上面的Library，然后就是这个样子的</p>
<p><strong> 2、重写activity_main.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"fill_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"fill_parent"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> &gt;</div><div class="line"><span class="comment">&lt;!--     The PullToRefreshListView replaces a standard ListView widget. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">com.handmark.pulltorefresh.library.PullToRefreshListView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/pull_refresh_list"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"fill_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"fill_parent"</span></div><div class="line">        <span class="attr">android:cacheColorHint</span>=<span class="string">"#00000000"</span></div><div class="line">        <span class="attr">android:divider</span>=<span class="string">"#19000000"</span></div><div class="line">        <span class="attr">android:dividerHeight</span>=<span class="string">"4dp"</span></div><div class="line">        <span class="attr">android:fadingEdge</span>=<span class="string">"none"</span></div><div class="line">        <span class="attr">android:fastScrollEnabled</span>=<span class="string">"false"</span></div><div class="line">        <span class="attr">android:footerDividersEnabled</span>=<span class="string">"false"</span></div><div class="line">        <span class="attr">android:headerDividersEnabled</span>=<span class="string">"false"</span></div><div class="line">        <span class="attr">android:smoothScrollbar</span>=<span class="string">"true"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>其中中间那一大段<com.handmark.pull………………>就是相当于ListView控件，用这段来代替原是ListView控件的代码</com.handmark.pull………………></p>
<p><strong> 3、JAVA代码讲解</strong><br>全部代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.example.try_pulltorefresh;</div><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"><span class="keyword">import</span> java.util.LinkedList;</div><div class="line"><span class="keyword">import</span> com.handmark.pulltorefresh.library.PullToRefreshBase;</div><div class="line"><span class="keyword">import</span> com.handmark.pulltorefresh.library.PullToRefreshListView;</div><div class="line"><span class="keyword">import</span> com.handmark.pulltorefresh.library.PullToRefreshBase.OnRefreshListener;</div><div class="line"><span class="keyword">import</span> android.os.AsyncTask;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.app.Activity;</div><div class="line"><span class="keyword">import</span> android.text.format.DateUtils;</div><div class="line"><span class="keyword">import</span> android.widget.ArrayAdapter;</div><div class="line"><span class="keyword">import</span> android.widget.ListView;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> String[] mStrings = &#123; <span class="string">"Abbaye de Belloc"</span>, <span class="string">"Abbaye du Mont des Cats"</span>, <span class="string">"Abertam"</span>, <span class="string">"Abondance"</span>, <span class="string">"Ackawi"</span>,</div><div class="line">			<span class="string">"Acorn"</span>, <span class="string">"Adelost"</span>, <span class="string">"Affidelice au Chablis"</span>, <span class="string">"Afuega'l Pitu"</span>, <span class="string">"Airag"</span>, <span class="string">"Airedale"</span>, <span class="string">"Aisy Cendre"</span>,</div><div class="line">			<span class="string">"Allgauer Emmentaler"</span>, <span class="string">"Abbaye de Belloc"</span>, <span class="string">"Abbaye du Mont des Cats"</span>, <span class="string">"Abertam"</span>, <span class="string">"Abondance"</span>, <span class="string">"Ackawi"</span>,</div><div class="line">			<span class="string">"Acorn"</span>, <span class="string">"Adelost"</span>, <span class="string">"Affidelice au Chablis"</span>, <span class="string">"Afuega'l Pitu"</span>, <span class="string">"Airag"</span>, <span class="string">"Airedale"</span>, <span class="string">"Aisy Cendre"</span>,</div><div class="line">			<span class="string">"Allgauer Emmentaler"</span> &#125;;</div><div class="line">	<span class="keyword">private</span> LinkedList&lt;String&gt; mListItems;</div><div class="line">	<span class="keyword">private</span> PullToRefreshListView mPullRefreshListView;</div><div class="line">	<span class="keyword">private</span> ArrayAdapter&lt;String&gt; mAdapter;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">		setContentView(R.layout.activity_main);</div><div class="line">		mPullRefreshListView = (PullToRefreshListView) findViewById(R.id.pull_refresh_list);</div><div class="line">		<span class="comment">// Set a listener to be invoked when the list should be refreshed.</span></div><div class="line">		mPullRefreshListView.setOnRefreshListener(<span class="keyword">new</span> OnRefreshListener&lt;ListView&gt;() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">(PullToRefreshBase&lt;ListView&gt; refreshView)</span> </span>&#123;</div><div class="line">				String label = DateUtils.formatDateTime(getApplicationContext(), System.currentTimeMillis(),</div><div class="line">						DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_SHOW_DATE | DateUtils.FORMAT_ABBREV_ALL);</div><div class="line">				<span class="comment">// Update the LastUpdatedLabel</span></div><div class="line">				refreshView.getLoadingLayoutProxy().setLastUpdatedLabel(label);</div><div class="line">				<span class="comment">// Do work to refresh the list here.</span></div><div class="line">				<span class="keyword">new</span> GetDataTask().execute();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		mListItems = <span class="keyword">new</span> LinkedList&lt;String&gt;();</div><div class="line">		mListItems.addAll(Arrays.asList(mStrings));</div><div class="line"></div><div class="line">		mAdapter = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>, android.R.layout.simple_list_item_1, mListItems);</div><div class="line">		<span class="comment">//这两个绑定方法用其一</span></div><div class="line">		<span class="comment">// 方法一</span></div><div class="line"><span class="comment">//		 mPullRefreshListView.setAdapter(mAdapter);</span></div><div class="line">		<span class="comment">//方法二</span></div><div class="line">		ListView actualListView = mPullRefreshListView.getRefreshableView();</div><div class="line">		actualListView.setAdapter(mAdapter);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">GetDataTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Void</span>, <span class="title">String</span>&gt; </span>&#123;</div><div class="line">		<span class="comment">//后台处理部分</span></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... params)</span> </span>&#123;</div><div class="line">			<span class="comment">// Simulates a background job.</span></div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				Thread.sleep(<span class="number">1000</span>);</div><div class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">			&#125;</div><div class="line">			String str=<span class="string">"Added after refresh...I add"</span>;</div><div class="line">			<span class="keyword">return</span> str;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="comment">//这里是对刷新的响应，可以利用addFirst（）和addLast()函数将新加的内容加到LISTView中</span></div><div class="line">		<span class="comment">//根据AsyncTask的原理，onPostExecute里的result的值就是doInBackground()的返回值</span></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(String result)</span> </span>&#123;</div><div class="line">			<span class="comment">//在头部增加新添内容</span></div><div class="line">			mListItems.addFirst(result);</div><div class="line">			</div><div class="line">			<span class="comment">//通知程序数据集已经改变，如果不做通知，那么将不会刷新mListItems的集合</span></div><div class="line">			mAdapter.notifyDataSetChanged();</div><div class="line">			<span class="comment">// Call onRefreshComplete when the list has been refreshed.</span></div><div class="line">			mPullRefreshListView.onRefreshComplete();</div><div class="line"></div><div class="line">			<span class="keyword">super</span>.onPostExecute(result);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="代码讲解："><a href="#代码讲解：" class="headerlink" title="代码讲解："></a>代码讲解：</h3><p><strong> 1、变量定义</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> LinkedList&lt;String&gt; mListItems;    <span class="comment">//显示的列表对应原字符串</span></div><div class="line"><span class="keyword">private</span> PullToRefreshListView mPullRefreshListView;  <span class="comment">//PullToRefreshListView实例</span></div><div class="line"><span class="keyword">private</span> ArrayAdapter&lt;String&gt; mAdapter;  <span class="comment">//ListView的适配器</span></div></pre></td></tr></table></figure></p>
<p><strong> 2、在OnCreate()中主要分为两步</strong><br>（1）初始化mPullRefreshListView并设置监听器，以执行当需要刷新时，应该怎么办，至于真正执行刷新的类GetDataTask（）我们后面再细讲，对应代码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mPullRefreshListView = (PullToRefreshListView) findViewById(R.id.pull_refresh_list);</div><div class="line"></div><div class="line"><span class="comment">// Set a listener to be invoked when the list should be refreshed.</span></div><div class="line">mPullRefreshListView.setOnRefreshListener(<span class="keyword">new</span> OnRefreshListener&lt;ListView&gt;() &#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">(PullToRefreshBase&lt;ListView&gt; refreshView)</span> </span>&#123;</div><div class="line">		String label = DateUtils.formatDateTime(getApplicationContext(), System.currentTimeMillis(),</div><div class="line">				DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_SHOW_DATE | DateUtils.FORMAT_ABBREV_ALL);</div><div class="line"></div><div class="line">		<span class="comment">// Update the LastUpdatedLabel</span></div><div class="line">		refreshView.getLoadingLayoutProxy().setLastUpdatedLabel(label);</div><div class="line"></div><div class="line">		<span class="comment">// Do work to refresh the list here.</span></div><div class="line">		<span class="keyword">new</span> GetDataTask().execute();</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>（2）设置适配器列表内容，并与ListView绑定以显示出来，对应代码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//设置列表内容  </span></div><div class="line">mListItems = <span class="keyword">new</span> LinkedList&lt;String&gt;();  </div><div class="line">mListItems.addAll(Arrays.asList(mStrings));  </div><div class="line">mAdapter = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>, android.R.layout.simple_list_item_1, mListItems);  </div><div class="line">  </div><div class="line"><span class="comment">//这两个绑定方法用其一  </span></div><div class="line"><span class="comment">// 方法一  </span></div><div class="line"><span class="comment">//       mPullRefreshListView.setAdapter(mAdapter);  </span></div><div class="line"><span class="comment">//方法二  </span></div><div class="line">ListView actualListView = mPullRefreshListView.getRefreshableView();  </div><div class="line">actualListView.setAdapter(mAdapter);</div></pre></td></tr></table></figure></p>
<p><strong> 3、执行刷新的类GetDataTask（）</strong><br>先贴出这段代码来：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">GetDataTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Void</span>, <span class="title">String</span>&gt; </span>&#123;<span class="comment">//定义返回值的类型  </span></div><div class="line">	<span class="comment">// 后台处理部分  </span></div><div class="line">	<span class="meta">@Override</span>  </div><div class="line">	<span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... params)</span> </span>&#123;  </div><div class="line">		<span class="comment">// Simulates a background job.  </span></div><div class="line">		<span class="keyword">try</span> &#123;  </div><div class="line">			Thread.sleep(<span class="number">1000</span>);  </div><div class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </div><div class="line">		&#125;  </div><div class="line">		String str=<span class="string">"Added after refresh...I add"</span>;  </div><div class="line">		<span class="keyword">return</span> str;  </div><div class="line">	&#125;  </div><div class="line"> </div><div class="line">	<span class="comment">//这里是对刷新的响应，可以利用addFirst（）和addLast()函数将新加的内容加到LISTView中  </span></div><div class="line">	<span class="comment">//根据AsyncTask的原理，onPostExecute里的result的值就是doInBackground()的返回值  </span></div><div class="line">	<span class="meta">@Override</span>  </div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(String result)</span> </span>&#123;  </div><div class="line">		<span class="comment">//在头部增加新添内容  </span></div><div class="line">		mListItems.addFirst(result);  </div><div class="line">		</div><div class="line">		<span class="comment">//通知程序数据集已经改变，如果不做通知，那么将不会刷新mListItems的集合  </span></div><div class="line">		mAdapter.notifyDataSetChanged();  </div><div class="line">		<span class="comment">// Call onRefreshComplete when the list has been refreshed.  </span></div><div class="line">		mPullRefreshListView.onRefreshComplete();  </div><div class="line"></div><div class="line">		<span class="keyword">super</span>.onPostExecute(result);<span class="comment">//这句是必有的，AsyncTask规定的格式  </span></div><div class="line">	&#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>（1）派生自AsyncTask<br>由于派生自AsyncTask，所以下面的那个函数doInBackground和onPostExecute就不难理解了，这两个函数是AsyncTask必须是重写的两个函数<br>（2）doInBackground函数<br>doInBackground 执行要于后台执行的语句，返回的值可以是任意类型，但要提前在extends AsyncTask<void, void,="" string=""> 中定义，这个返回值会做为onPostExecute的参数result传到onPostExecute函数中；如果对于网络访问程 序，doInBackground就执行访问网络的代码，然后讲返回值存在result中传给onPostExecute函数，以刷新列表；<br>（3）onPostExecute函数<br> onPostExecute（）是对返回的值进行操作，并添加到ListView的列表中，有两种添加方式添加到头部—-mListItems.addFirst(result);和添加在尾部—-mListItems.addLast(result);</void,></p>
<p>至于 AsyncTask，下面是几个网页，讲的还可以，大家可以参考下：</p>
<ul>
<li><a href="http://www.eoeandroid.com/thread-168004-1-1.html" target="_blank" rel="external">《android AsyncTask 详解》</a></li>
<li><a href="http://blog.csdn.net/dabizime/article/details/6695705" target="_blank" rel="external">《android AsyncTask 详解》（同名）</a></li>
<li><a href="http://blog.csdn.net/singwhatiwanna/article/details/9272195" target="_blank" rel="external">《android之AsyncTask》</a></li>
<li><p><a href="http://blog.csdn.net/singwhatiwanna/article/details/17596225" target="_blank" rel="external">《Android源码分析–带你认识不一样的AsyncTask》</a></p>
<h2 id="附加说明"><a href="#附加说明" class="headerlink" title="附加说明"></a>附加说明</h2><p>设置向上拉刷新还是向下拉刷新的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mPullRefreshListView.setMode(Mode.PULL_FROM_END);<span class="comment">//向下拉刷新</span></div><div class="line">mPullRefreshListView.setMode(Mode.PULL_FROM_START);<span class="comment">//向上拉刷新</span></div><div class="line">mPullRefreshListView.setMode(Mode.BOTH);<span class="comment">//两端刷新</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>注意：这只是一个精简版，在源码中还有一些可借签的代码，可以在看懂这个以后，可以回过头来再看看源码，我相信肯定会有收获的。</p>
<h2 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h2><ul>
<li><a href="http://download.csdn.net/detail/harvic880925/6788247" target="_blank" rel="external">PullToRefresh使用详解（二）—— ListView的下拉刷新与上拉加载</a></li>
</ul>
<h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><ul>
<li><a href="http://blog.csdn.net/harvic880925/article/details/17680305" target="_blank" rel="external">原文地址</a></li>
<li><a href="http://download.csdn.net/detail/harvic880925/6788247" target="_blank" rel="external">源码下载</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/04/android_pulltorefresh_listview/" data-id="cj4zx2kiq003bqonh3h76f93u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/listview/">listview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pulltorefresh/">pulltorefresh</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/8/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/article/">article</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/coding/">coding</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/framework/">framework</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/humanism/">humanism</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/message-push/">message_push</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/music/">music</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ndk/">ndk</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/note/">note</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/protocol/">protocol</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/reading/">reading</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/springmvc/">springmvc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/string/">string</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/study/">study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/versioncontroll/">versioncontroll</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/好文/">好文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/电影/">电影</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AliPay/">AliPay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Einstein/">Einstein</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GreenDao/">GreenDao</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ORMLite/">ORMLite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WXPay/">WXPay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/activity/">activity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android-studio/">android_studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android-ui/">android_ui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/androidstudio/">androidstudio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/application/">application</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/broadcast/">broadcast</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bugfix/">bugfix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chinese-weman/">chinese_weman</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/code-collection/">code_collection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/context/">context</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/decomplication/">decomplication</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design-model/">design model</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eclipse/">eclipse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eventbus/">eventbus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/feminism/">feminism</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullstack/">fullstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google/">google</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/handle/">handle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/handler/">handler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/humanism/">humanism</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iframe/">iframe</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/image/">image</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/imageloader/">imageloader</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/intent/">intent</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/intentflag/">intentflag</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iphone/">iphone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jni/">jni</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/listview/">listview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/material-design/">material_design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/">music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mvp/">mvp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nd/">nd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notification/">notification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/obfuscation/">obfuscation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/observer/">observer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opensource/">opensource</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/otto/">otto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pageradapter/">pageradapter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pay/">pay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/placeholder/">placeholder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/project-build/">project_build</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pulltorefresh/">pulltorefresh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pulltorefreshlistview/">pulltorefreshlistview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/saxophone/">saxophone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/screen-record/">screen-record</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shortkey/">shortkey</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/snack/">snack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sort/">sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spannable/">spannable</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/speech/">speech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springmvc/">springmvc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlite/">sqlite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssl/">ssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svg/">svg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svn/">svn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/templates/">templates</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/textview/">textview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/translate/">translate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/viewpager/">viewpager</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/volley/">volley</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/website/">website</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webview/">webview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xpnet/">xpnet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/书单/">书单</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/史玉柱/">史玉柱</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/感悟/">感悟</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/电影/">电影</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贾樟柯/">贾樟柯</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AliPay/" style="font-size: 10px;">AliPay</a> <a href="/tags/Einstein/" style="font-size: 10px;">Einstein</a> <a href="/tags/GreenDao/" style="font-size: 10px;">GreenDao</a> <a href="/tags/ORMLite/" style="font-size: 10px;">ORMLite</a> <a href="/tags/WXPay/" style="font-size: 10px;">WXPay</a> <a href="/tags/activity/" style="font-size: 10px;">activity</a> <a href="/tags/android-studio/" style="font-size: 10px;">android_studio</a> <a href="/tags/android-ui/" style="font-size: 10px;">android_ui</a> <a href="/tags/androidstudio/" style="font-size: 20px;">androidstudio</a> <a href="/tags/animation/" style="font-size: 20px;">animation</a> <a href="/tags/application/" style="font-size: 10px;">application</a> <a href="/tags/book/" style="font-size: 10px;">book</a> <a href="/tags/broadcast/" style="font-size: 10px;">broadcast</a> <a href="/tags/bugfix/" style="font-size: 13.33px;">bugfix</a> <a href="/tags/chinese-weman/" style="font-size: 10px;">chinese_weman</a> <a href="/tags/code-collection/" style="font-size: 10px;">code_collection</a> <a href="/tags/context/" style="font-size: 10px;">context</a> <a href="/tags/database/" style="font-size: 10px;">database</a> <a href="/tags/decomplication/" style="font-size: 10px;">decomplication</a> <a href="/tags/design-model/" style="font-size: 13.33px;">design model</a> <a href="/tags/eclipse/" style="font-size: 10px;">eclipse</a> <a href="/tags/eventbus/" style="font-size: 10px;">eventbus</a> <a href="/tags/feminism/" style="font-size: 10px;">feminism</a> <a href="/tags/fullstack/" style="font-size: 10px;">fullstack</a> <a href="/tags/github/" style="font-size: 13.33px;">github</a> <a href="/tags/google/" style="font-size: 10px;">google</a> <a href="/tags/gradle/" style="font-size: 16.67px;">gradle</a> <a href="/tags/handle/" style="font-size: 10px;">handle</a> <a href="/tags/handler/" style="font-size: 10px;">handler</a> <a href="/tags/hexo/" style="font-size: 16.67px;">hexo</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/humanism/" style="font-size: 10px;">humanism</a> <a href="/tags/iframe/" style="font-size: 10px;">iframe</a> <a href="/tags/image/" style="font-size: 10px;">image</a> <a href="/tags/imageloader/" style="font-size: 20px;">imageloader</a> <a href="/tags/intent/" style="font-size: 10px;">intent</a> <a href="/tags/intentflag/" style="font-size: 13.33px;">intentflag</a> <a href="/tags/iphone/" style="font-size: 10px;">iphone</a> <a href="/tags/jni/" style="font-size: 10px;">jni</a> <a href="/tags/listview/" style="font-size: 10px;">listview</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/material-design/" style="font-size: 10px;">material_design</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/music/" style="font-size: 13.33px;">music</a> <a href="/tags/mvp/" style="font-size: 10px;">mvp</a> <a href="/tags/mysql/" style="font-size: 16.67px;">mysql</a> <a href="/tags/nd/" style="font-size: 10px;">nd</a> <a href="/tags/notification/" style="font-size: 10px;">notification</a> <a href="/tags/obfuscation/" style="font-size: 10px;">obfuscation</a> <a href="/tags/observer/" style="font-size: 10px;">observer</a> <a href="/tags/opensource/" style="font-size: 13.33px;">opensource</a> <a href="/tags/otto/" style="font-size: 10px;">otto</a> <a href="/tags/pageradapter/" style="font-size: 10px;">pageradapter</a> <a href="/tags/pay/" style="font-size: 13.33px;">pay</a> <a href="/tags/placeholder/" style="font-size: 10px;">placeholder</a> <a href="/tags/project-build/" style="font-size: 10px;">project_build</a> <a href="/tags/pulltorefresh/" style="font-size: 10px;">pulltorefresh</a> <a href="/tags/pulltorefreshlistview/" style="font-size: 13.33px;">pulltorefreshlistview</a> <a href="/tags/saxophone/" style="font-size: 10px;">saxophone</a> <a href="/tags/screen-record/" style="font-size: 10px;">screen-record</a> <a href="/tags/shortkey/" style="font-size: 10px;">shortkey</a> <a href="/tags/snack/" style="font-size: 10px;">snack</a> <a href="/tags/socket/" style="font-size: 10px;">socket</a> <a href="/tags/sort/" style="font-size: 13.33px;">sort</a> <a href="/tags/spannable/" style="font-size: 10px;">spannable</a> <a href="/tags/speech/" style="font-size: 10px;">speech</a> <a href="/tags/springmvc/" style="font-size: 10px;">springmvc</a> <a href="/tags/sqlite/" style="font-size: 10px;">sqlite</a> <a href="/tags/ssl/" style="font-size: 13.33px;">ssl</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/svg/" style="font-size: 13.33px;">svg</a> <a href="/tags/svn/" style="font-size: 13.33px;">svn</a> <a href="/tags/templates/" style="font-size: 10px;">templates</a> <a href="/tags/textview/" style="font-size: 10px;">textview</a> <a href="/tags/tomcat/" style="font-size: 16.67px;">tomcat</a> <a href="/tags/translate/" style="font-size: 10px;">translate</a> <a href="/tags/viewpager/" style="font-size: 13.33px;">viewpager</a> <a href="/tags/volley/" style="font-size: 10px;">volley</a> <a href="/tags/website/" style="font-size: 13.33px;">website</a> <a href="/tags/webview/" style="font-size: 10px;">webview</a> <a href="/tags/xpnet/" style="font-size: 13.33px;">xpnet</a> <a href="/tags/书单/" style="font-size: 10px;">书单</a> <a href="/tags/史玉柱/" style="font-size: 10px;">史玉柱</a> <a href="/tags/感悟/" style="font-size: 10px;">感悟</a> <a href="/tags/电影/" style="font-size: 10px;">电影</a> <a href="/tags/贾樟柯/" style="font-size: 10px;">贾樟柯</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/11/study_my_website_collection/">常用网站收集</a>
          </li>
        
          <li>
            <a href="/2016/05/04/web_develop_config/">WEB开发之环境配置</a>
          </li>
        
          <li>
            <a href="/2016/05/04/web_springmvc1/">Spring MVC入门(一)</a>
          </li>
        
          <li>
            <a href="/2016/04/07/android_network_ssl/">为你的Android App实现自签名的SSL证书</a>
          </li>
        
          <li>
            <a href="/2016/03/28/android_notification_push/">Android实现推送方式解决方案</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 ARESXIONG<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>